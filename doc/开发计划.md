# APP 后端开发计划

基于《功能需求文档》与《开发方案》制定的约 12 周**后端**开发计划，按「基础与 MVP → 核心业务 → 社交与完善」分阶段推进。

---

## 一、总体安排

| 阶段       | 周期       | 起止时间     | 目标概要                         |
|------------|------------|--------------|----------------------------------|
| 第 1 个月  | Week 1–4   | 1/30~2/27    | 基础框架、用户体系、问答核心、互动 |
| 第 2 个月  | Week 5–8   | 2/28~3/27    | 悬赏与钱包、支付、活动、搜索与通知 |
| 第 3 个月  | Week 9–12  | 3/28~4/27    | 社交功能、热榜与频道、紧急求助、联调与上线准备 |

**产出约定**：接口在 Apifox（https://app.apifox.com/）维护；后端按开发方案分服务实现；各阶段以接口可用、服务可测为准。

---

## 二、第 1 个月：基础与 MVP

### Week 1：基础框架与基础设施（1/30~2/6）

- 工程初始化：Spring Boot / Spring Cloud、父 POM、公共模块（common-core、common-security、common-web）。
- 基础设施：MySQL 建库与基础表（用户、问题、回答、评论等核心表）；Redis、RabbitMQ 接入；本地/测试环境 Docker Compose。
- 网关：Spring Cloud Gateway 搭建，路由、统一鉴权（JWT）、跨域；限流熔断方案在网关注册（按开发方案 4.5 节策略）。
- Apifox：创建项目，定义统一响应格式、错误码；先定用户、认证相关接口文档与 Mock。

**交付**：网关可访问、MySQL/Redis/RabbitMQ 可用、Apifox 用户/认证接口文档与 Mock 就绪，认证相关接口可调通。

---

### Week 2：用户服务与认证（2/7~2/13）

- 用户服务：注册、登录（含社交登录预留）、JWT 签发与刷新、用户信息 CRUD、头像上传（对接对象存储预留）。
- 用户统计与关注：粉丝数/关注数/点赞数等统计表与接口；关注/取消关注接口。
- 在 Apifox 中完善用户、关注相关接口并同步 Mock。

**交付**：用户注册/登录/鉴权接口可用，用户信息与关注接口就绪，Apifox 文档与 Mock 更新。

---

### Week 3：内容服务（问题与回答）（2/14~2/20）

- 内容服务：问题发布（类型：公开/悬赏/定向）、问题列表（分页、排序）、问题详情；回答发布、回答列表（精选/最新）、采纳与补充回答；草稿保存与列表。
- 问题与回答的图片上传、话题标签关联；浏览量、计数（回答数/评论数/补充数）更新。
- 互动服务：点赞/点踩、收藏（问题、回答、补充）；Redis 计数 + 异步落库，防刷（按开发方案 4.1–4.3）。

**交付**：问题/回答/草稿/互动相关接口可用，完整「提问 → 回答 → 采纳」主流程可经接口走通；Apifox 内容与互动接口更新。

---

### Week 4：评论、补充与首页接口（2/21~2/27）

- 评论：对问题/回答/补充的一级评论与回复、评论列表分页、评论点赞与计数。
- 补充：对问题或回答的补充列表、排序（精选/最新）、补充的互动计数。
- 首页/列表：按频道/分类拉取问题列表（先简单分类或「全部」）；地区参数预留。

**交付**：评论与补充接口闭环；首页/列表接口可按分类/频道筛选；第 1 个月后端 MVP（用户 + 问答 + 互动）接口就绪。

---

## 三、第 2 个月：核心业务

### Week 5：悬赏与钱包基础（2/28~3/6）

- 钱包服务：用户钱包表、余额与冻结额；充值/提现接口（先对接 Stripe 或 PayPal 其一）；流水表与流水查询接口。
- 悬赏：发布悬赏问题扣款、追加悬赏扣款；采纳答案时发放给回答者；与钱包服务通过消息队列或 Seata 做最终一致性（参考开发方案 7.2）。

**交付**：悬赏发布 → 采纳 → 到账流程接口打通；充值/提现接口可走通（测试环境）；Apifox 更新支付与钱包相关接口。

---

### Week 6：支付接入与对账（3/7~3/13）

- 支付接入（参考开发方案 7.6）：统一支付层、Stripe/PayPal 回调验签与幂等、订单状态机；退款/部分退款接口。
- 支付监控与对账：日志记录、失败原因统计；与支付方对账脚本或任务（可先日级）。

**交付**：充值/提现/退款接口在测试环境稳定可用；支付相关接口在 Apifox 定稿。

---

### Week 7：活动与通知（3/14~3/20）

- 活动服务：活动 CRUD、活动列表（全部/热门/新活动/已结束/我的）、活动详情、报名与取消、人数与状态（报名中/已满/已结束）；Redis 分布式锁控制报名人数。
- 通知服务：站内通知（回答、评论、点赞、关注、活动提醒）；表结构、列表与已读接口；通过 RabbitMQ 异步发通知。
- 推送：FCM 集成（参考开发方案 7.5），设备 token 管理、推送发送与失败重试；关键通知（如悬赏采纳）推送 + 站内信。

**交付**：活动与报名相关接口、站内通知与推送接口可用；Apifox 活动与通知接口更新。

---

### Week 8：搜索与热榜基础（3/21~3/27）

- 搜索服务：Elasticsearch 索引（问题、回答、用户）；全文搜索、搜索建议、热门搜索词接口；IK 分词与基础排序（参考开发方案 7.4）。
- 热榜：Redis Sorted Set 存储热榜；热度分数计算（点赞、评论、回答、浏览、时间衰减）；定时任务更新全站/国家/行业热榜（可先做全站）。

**交付**：搜索与热榜接口可用；第 2 个月核心业务（悬赏、支付、活动、通知、搜索、热榜）后端接口就绪。

---

## 四、第 3 个月：社交与完善

### Week 9：关注与邀请（3/28~4/3）

- 用户关注：关注/粉丝列表、互关逻辑；「关注」信息流接口（可选）。
- 邀请回答：站内邀请（按用户搜索、推荐用户）、邀请记录与状态接口；预留 Twitter/Facebook 分享邀请（可先占位）。

**交付**：关注与邀请回答相关接口可用；邀请接口在 Apifox 定稿。

---

### Week 10：问题团队与群组（4/4~4/10）

- 问题团队：围绕问题的团队创建、列表、加入/申请、成员与角色接口；团队内讨论或留言（可与评论/补充复用或独立表）。
- 群组：问题群组创建、加入、群组留言列表与发布接口；群组与问题的关联。

**交付**：问题团队与问题群组相关接口可用。

---

### Week 11：频道、紧急求助与收尾功能（4/11~4/17）

- 频道管理：频道列表（我的/国家/行业等）、订阅与取消接口；按用户订阅频道拉取内容的接口。
- 紧急求助：求助发布（标题、分类、描述、联系方式、位置）；位置存储与「附近 5km」推送范围；每日免费次数限制；推送给附近用户（推送 + 站内列表接口）。
- 举报：举报问题/回答/用户接口，举报原因与处理状态；管理端可后续迭代。
- 付费查看答案（若需求明确）：支付后可见、权限校验接口。

**交付**：频道、紧急求助、举报、付费答案（若做）相关接口就绪。

---

### Week 12：联调、测试与上线准备（4/18~4/27）

- 全链路联调：网关限流熔断、各服务间调用与消息队列、支付回调与对账、推送送达率与降级。
- 性能与安全：接口压测（P95/P99 参考开发方案 4.4）、慢 SQL 与索引优化、缓存命中率；敏感数据与支付安全复查。
- 日志、监控与告警：关键接口与支付/推送的监控与告警；便于上线后排查。

**交付**：后端测试报告与已知问题列表；上线检查清单（配置、密钥、监控、回滚方案）；后端具备上线条件。

---
## 五、风险与依赖

- **支付与合规**：海外支付（Stripe/PayPal）需提前申请账号与合规配置；对账与异常处理尽早接入。
- **推送稳定性**：FCM 与设备 token 管理、送达率监控与站内信/短信兜底按开发方案 7.5 落实，避免后期返工。
- **接口协作**：接口以 Apifox 为准，变更及时同步文档与 Mock，便于前端或其他调用方联调。
- **人员与排期**：若人力紧张，可优先保证「用户 + 问答 + 悬赏与支付 + 活动 + 通知」；频道、团队、群组、紧急求助可做裁剪或延后，在计划中标注为可选/二期。

仅覆盖后端开发，实施时可按实际情况调整优先级。
